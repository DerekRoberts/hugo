{{- $currentPage := .currentPage }}
{{- $hideHome := .hideHome | default false }}
{{- $menuID := .menuID | default "" }}
{{- $menuClass := .menuClass | default "nav-menu" }}
{{- $itemClass := .itemClass | default "nav-item" }}
{{- $linkClass := .linkClass | default "nav-link" }}
{{- $useSpan := .useSpan | default false }}
{{- $useIsMenuCurrent := .useIsMenuCurrent | default false }}
<ul{{ if $menuID }} id="{{ $menuID }}" {{ end }}{{ if $menuClass }} class="{{ $menuClass }}" {{ end }}>
    {{- range site.Menus.main }}
    {{- if or (not $hideHome) (ne .Name "Home") }}
    {{- $menu_item_url := (cond (strings.HasSuffix .URL "/") .URL (printf "%s/" .URL) ) | absLangURL }}
    {{- $page_url := "" }}
    {{- $is_active := false }}
    {{- if $currentPage }}
    {{- if $useIsMenuCurrent }}
    {{- $is_active = $currentPage.IsMenuCurrent "main" . }}
    {{- else }}
    {{- $page_url = $currentPage.Permalink | absLangURL }}
    {{- $is_active = eq $menu_item_url $page_url }}
    {{- end }}
    {{- end }}
    {{- $is_search := false }}
    {{- if .KeyName }}
    {{- with site.GetPage .KeyName }}
    {{- $is_search = eq .Layout "search" }}
    {{- end }}
    {{- end }}
    {{- $is_external := findRE "://" .URL }}
    <li{{ if $itemClass }} class="{{ $itemClass }}" {{ end }}>
        <a href="{{ .URL | absLangURL }}" {{- if or $linkClass $is_active }}
            class="{{ if $linkClass }}{{ $linkClass }}{{ end }}{{ if $is_active }} active{{ end }}" {{- end }} {{- if
            $is_search }} title="{{ .Title | default .Name }} (Alt + /)" accesskey="/" {{- else if .Title }}
            title="{{ .Title | default .Name }}" {{- end }} {{- if $is_external }} target="_blank"
            rel="noopener noreferrer" {{- end }}>
            {{- if $useSpan }}
            <span {{- if $is_active }} class="active" {{- end }}>
                {{- .Pre }}
                {{- .Name -}}
                {{- .Post -}}
            </span>
            {{- else }}
            {{- .Pre }}
            {{- .Name -}}
            {{- .Post -}}
            {{- end }}
        </a>
        </li>
        {{- end }}
        {{- end }}
        </ul>
